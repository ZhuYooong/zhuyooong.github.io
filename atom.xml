<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Zhuyooong’ Blog]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://yoursite.com/"/>
  <updated>2016-07-23T08:55:43.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name><![CDATA[Zhuyooong]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[iOS集成极光推送遇到的几个问题]]></title>
    <link href="http://yoursite.com/2016/02/02/iOS%E9%9B%86%E6%88%90%E6%9E%81%E5%85%89%E6%8E%A8%E9%80%81%E9%81%87%E5%88%B0%E7%9A%84%E5%87%A0%E4%B8%AA%E9%97%AE%E9%A2%98/"/>
    <id>http://yoursite.com/2016/02/02/iOS集成极光推送遇到的几个问题/</id>
    <published>2016-02-02T12:42:51.000Z</published>
    <updated>2016-07-23T08:55:43.000Z</updated>
    <content type="html"><![CDATA[<p>其实官方的<a href="http://docs.jpush.io/guideline/ios_guide" target="_blank" rel="external">iOS SDK 集成指南</a>和<a href="http://docs.jpush.io/client/ios_tutorials" target="_blank" rel="external">iOS SDK 教程</a>两个文档关于集成时的大部分问题都可以解决，所以我这里只是讨论我遇见的文档里表述不明白的那几个坑（<a href="http://docs.jpush.io/resources/" target="_blank" rel="external">2.1.0版本的</a>）。</p>
<h1>1、APNs证书和主证书的区别</h1>
<p><img src="https://cvws.icloud-content.com/B/AScgqJSKWtgXz59DOHsSHkKzJWU8AQdu3X7orEuKpyPadtKqrhfEIvGS/Jpush1.png?o=AqAMjkft6FPn7n6d2qDdfzFahvqWy7JnCUr3Tr_xNv2S&amp;v=1&amp;x=3&amp;a=BXsDc7y1zxpnA0ecNA&amp;e=1469176719&amp;k=Ggyyyon4TDIb2rfAGl-s2w&amp;fl=&amp;r=fd4497c6-66a4-4bbc-a5d1-811084e1bb22-1&amp;ckc=com.apple.clouddocs&amp;ckz=com.apple.CloudDocs&amp;p=34&amp;s=6Iq55hvv2ahvW-y93K4eozharU8&amp;cd=i" alt="">
我刚开始做推送的时候本来以为APNs证书就是主证书里加了个允许推送而已，事实证明我还是太天真了。
<img src="https://cvws.icloud-content.com/B/Aeobgf4StnPqlykp6zJHMgNn_G2TAVniPmzwqKFTFcPcfT29TKULndVq/Jpush2.png?o=Ajas5vdX4-aJgecyPgXZdNy2xnpicsevUypwDi0tLjUm&amp;v=1&amp;x=3&amp;a=BV6_UaAjzsAXA0icNA&amp;e=1469176764&amp;k=lZFSWhrLVhqbLVXKAeq-OQ&amp;fl=&amp;r=9363ee56-bcfe-4960-aac0-d4b11bfeb1a4-1&amp;ckc=com.apple.clouddocs&amp;ckz=com.apple.CloudDocs&amp;p=34&amp;s=a_BgMicIaVc2gwqO-1-RDML_1Jk&amp;cd=i" alt="">
首先是创建Provisioning Profile文件时选择证书列表时是不能选择APNs证书的，而且在XCode里Code Signing也是不能选择的。
APNs证书其实是只表示了有推送功能，主证书还是必不可少的。所以现在只是又添加了两个证书，其他的是不用变的，所以现在就有4个证书了。作为一个有轻微强迫症的人，创建完APNs证书就顺手把主证书删了，在这里让我折腾了好久。</p>
<h1>2、启动SDK需要传的参数</h1>
<p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)<span class="string">setupWithOption:</span>(NSDictionary *)launchingOption</span><br><span class="line"><span class="string">appKey:</span>(NSString *)appKey</span><br><span class="line"><span class="string">channel:</span>(NSString *)channel</span><br><span class="line"><span class="string">apsForProduction:</span>(BOOL)isProduction;</span><br></pre></td></tr></table></figure></p>
<p>前两个就不必说了。
channel 发布渠道。我刚开始也不知道要怎么填，iOS?App Store?Publish channel?其实这只是一个标识而已，不会有什么具体影响。而且是可选的，所以填nil也是没关系的。
isProduction 是否生产环境。看起来很有用的一个参数，但实际发现YES或NO是没区别的，在框架里边应该是另有判断。但还必须得填，所以在生产和开发环境之间切换时是没必要一定要改这个参数的。</p>
<h1>3、<a href="http://docs.jpush.io/client/ios_api/#api-ios" target="_blank" rel="external">标签与别名 API</a></h1>
<p>之前的教程文档是没有这个的，下载的Demo里也没有。但是项目里肯定是要有这个的。</p>
<blockquote>
<h3>别名 alias</h3>
<p>为安装了应用程序的用户，取个别名来标识。以后给该用户 Push 消息时，就可以用此别名来指定。每个用户只能指定一个别名。</p>
<h3>标签 tag</h3>
<p>为安装了应用程序的用户，打上标签。其目的主要是方便开发者根据标签，来批量下发 Push 消息。可为每个用户打多个标签。</p>
</blockquote>
<p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>) setTags:(<span class="built_in">NSSet</span> *)tags alias:(<span class="built_in">NSString</span> *)alias fetchCompletionHandle:(<span class="keyword">void</span> (^)(<span class="keyword">int</span> iResCode, <span class="built_in">NSSet</span> *iTags, <span class="built_in">NSString</span> *iAlias))completionHandler;</span><br></pre></td></tr></table></figure></p>
<p>call back结果可以忽略，但最好判断一下， 返回值为 0 才设置成功，才可以向目标推送。我一般是有block就不会用其他的，但使用block时需要注意循环引用问题。而且这个方法是覆盖之前的设置，不是新增。
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ <span class="comment">(void)</span>setTags:<span class="comment">(NSSet *)</span>tags callbackSelector:<span class="comment">(SEL)</span>cbSelector object:<span class="comment">(id)</span>theTarget;</span><br><span class="line">+ <span class="comment">(void)</span>setAlias:<span class="comment">(NSString *)</span>alias callbackSelector:<span class="comment">(SEL)</span>cbSelector object:<span class="comment">(id)</span>theTarget;</span><br></pre></td></tr></table></figure></p>
<p>tag和alias分别设置会比只调同时设置两个的那个接口稳定，虽然我也不知道为什么。</p>
<h1>4、收到通知后的处理</h1>
<p><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- <span class="params">(void)</span>application:<span class="params">(UIApplication *)</span>application didReceiveRemoteNotification:<span class="params">(NSDictionary *)</span>userInfo fetchCompletionHandler:<span class="params">(void (^)</span><span class="params">(UIBackgroundFetchResult result)</span>)completionHandler</span><br></pre></td></tr></table></figure></p>
<p>是在iOS7之后的方法，所以之前的方法可以不用了。
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- <span class="params">(void)</span>applicationWillEnterForeground:<span class="params">(UIApplication *)</span>application</span><br></pre></td></tr></table></figure></p>
<p>applicationWillEnterForegroun是在didReceiveRemoteNotification之后运行的，所以在这个方法里想处数据是不行的。然后<code>[application setApplicationIconBadgeNumber:0];</code>是偶尔会抽风一下的，所以最好这样写：
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[application setApplicationIconBadgeNumber:1]</span><span class="comment">;</span></span><br><span class="line"><span class="section">[application setApplicationIconBadgeNumber:0]</span><span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<p>当然，不要忘了<code>[application cancelAllLocalNotifications];</code></p>
<p>还有，关于跳转到特定页面的问题。反正我是没找到如何在AppDelegate里找到当前的页面，所以只能用<code>self.window.rootViewController</code>了。返回的话直接<code>self.view.window.rootViewController = vc;</code>吧。
记得用<code>application.applicationState == UIApplicationStateActive</code>判断一下应用处于的状态。如果用户正在运行应用，或许还有更好的，但我就是弹一个UIAlertView。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>其实官方的<a href="http://docs.jpush.io/guideline/ios_guide" target="_blank" rel="external">iOS SDK 集成指南</a>和<a href="http://docs.jpush.io/cli]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Markdown语言对照]]></title>
    <link href="http://yoursite.com/2016/01/04/Markdown%E8%AF%AD%E8%A8%80%E5%AF%B9%E7%85%A7/"/>
    <id>http://yoursite.com/2016/01/04/Markdown语言对照/</id>
    <published>2016-01-04T07:11:28.000Z</published>
    <updated>2016-07-23T08:54:54.000Z</updated>
    <content type="html"><![CDATA[<h1>标题</h1>
<ul>
<li>H1 :</li>
</ul>
<h1>Header 1 <code># Header1</code> or 下一行加三个等号｀===｀</h1>
<ul>
<li>H2 :</li>
</ul>
<h2>Header 2 <code>## Header 2</code></h2>
<ul>
<li>H3 :</li>
</ul>
<h3>Header 3 <code>### Header 3</code></h3>
<ul>
<li>H4 :</li>
</ul>
<h4>Header 4 <code>#### Header 4</code></h4>
<ul>
<li>H5 :</li>
</ul>
<h5>Header 5 <code>##### Header 5</code></h5>
<ul>
<li>H6 :</li>
</ul>
<h6>Header 6 <code>###### Header 6</code></h6>
<h1>列表</h1>
<ul>
<li>无序列表（使用星号、加号或减号）</li>
</ul>
<ul>
<li>First</li>
<li>Second</li>
<li>Third</li>
</ul>
<ul>
<li>有序列表（用数字接着一个英文句点）</li>
</ul>
<ol>
<li>First</li>
<li>Second</li>
<li>Third</li>
</ol>
<h1>文本样式</h1>
<ul>
<li>
<p>加粗:<strong>Bold</strong> <code>**Bold**</code> or <code>__Bold__</code></p>
</li>
<li>
<p>斜体字:<em>Italics</em> <code>*Italics*</code> or <code>_Italics_</code></p>
</li>
<li>
<p>斜粗体:<strong><em>text</em></strong> <code>***text***</code> or <code>___text___</code>
（如果要在文字前后直接插入普通的星号或底线，用反斜线（转义符）：*this text is surrounded by literal asterisks* <code>\*this text is surrounded by literal asterisks\*</code>）</p>
</li>
<li>
<p>小型文本：&lt;small&gt;文本内容&lt;/small&gt; <code>&lt;small&gt;文本内容&lt;/small&gt;</code></p>
</li>
<li>
<p>删除线:<s>text</s> 两边加~~</p>
</li>
<li>
<p>快捷键：&lt;kbd&gt;Ctrl+[&lt;/kbd&gt; <code>&lt;kbd&gt;Ctrl+[&lt;/kbd&gt;</code>
* 内嵌代码/高亮 :<code>alert('Hello World');</code> <code>`alert('Hello World');`</code> （如果高亮的内容包含 ` 号，可以用 `` 包裹起来）
* 代码块:（用 <figure class="highlight plain"><figcaption><span>~~~ 包裹或者每行缩进4个空格或2个制表符)</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> </span><br></pre></td></tr></table></figure></p>
<pre><code>           lazy var formatter: NSDateFormatter = {
           let dateFormatter = NSDateFormatter()
           dateFormatter.formatterBehavior = .Behavior10_4
           dateFormatter.dateFormat = &quot;HH:mm:ss.SSS&quot;
           return dateFormatter
           }()
           <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 分割线 <span class="symbol">:<span class="string">`___`</span></span> <span class="keyword">or</span> <span class="string">`***`</span></span><br><span class="line">__<span class="number">_</span></span><br><span class="line">* 表格：左对齐是<span class="symbol">:---</span>   居中对齐是<span class="symbol">:---</span>:   右对齐是---:</span><br><span class="line"></span><br><span class="line">Woow <span class="params">| Woow |</span> Woow</span><br><span class="line"><span class="symbol">:-----|</span><span class="symbol">:-----</span><span class="symbol">:|</span> ----:</span><br><span class="line">Woow <span class="params">| Woow |</span> Woow</span><br><span class="line">Woow <span class="params">| Woow |</span> Woow</span><br><span class="line">Woow <span class="params">| Woow |</span> Woow</span><br></pre></td></tr></table></figure>

           Woow | Woow | Woow
           :-----|:-----:| ----:
           Woow | Woow | Woow
           Woow | Woow | Woow
           Woow | Woow | Woow
           <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="section"># 引用</span></span><br><span class="line"><span class="quote">&gt; 大楚兴，陈胜王！</span></span><br><span class="line"></span><br><span class="line"><span class="code">`&gt; 大楚兴，陈胜王！`</span>(和下文要隔一行)</span><br><span class="line"></span><br><span class="line"><span class="section">##### 区块引用可以嵌套</span></span><br><span class="line"><span class="quote">&gt; This is the first level of quoting.</span></span><br><span class="line"><span class="quote">&gt; &gt; This is nested block quote.</span></span><br><span class="line"><span class="quote">&gt;</span><br><span class="line">&gt; Back to the first level.</span></span><br><span class="line"></span><br><span class="line"><span class="strong">**引用的区块内也可以使用其他的 Markdown 语法**</span></span><br><span class="line"><span class="quote">&gt; ## 这是一个标题。</span></span><br><span class="line"><span class="quote">&gt;</span><br><span class="line">&gt; 1.   这是第一行列表项。</span></span><br><span class="line"><span class="quote">&gt; 2.   这是第二行列表项。</span></span><br><span class="line"><span class="quote">&gt;</span><br><span class="line">&gt; 给出一些例子代码：</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>

           &gt;return shell_exec(&quot;echo $input | $markdown_script&quot;);<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="section"># 链接</span></span><br><span class="line"><span class="bullet">* </span>网络链接 :[<span class="string">Baidu</span>](<span class="link">https://www.baidu.com</span>) <span class="code">`[Baidu](https://www.baidu.com)`</span> or</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<p>[Baidu][id]
[id]:https://www.baidu.com <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>本地链接 :[<span class="string">link text</span>](<span class="link">file:///Users/mac/Desktop/Test/README.md "link text"</span>) <span class="code">`[link text](file:///Users/mac/Desktop/Test/README.md "link text")`</span></span><br><span class="line"><span class="bullet">* </span>网络图片 :<span class="code">`![德鲁伊](http://upload-images.jianshu.io/upload_images/1334313-93fdf2ca0d08b8ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)`</span></span><br><span class="line">![<span class="string">德鲁伊</span>](<span class="link">http://upload-images.jianshu.io/upload_images/1334313-93fdf2ca0d08b8ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240</span>)</span><br><span class="line"><span class="bullet">* </span>本地图片 :<span class="code">`![新浪](http://upload-images.jianshu.io/upload_images/1334313-76fcda5b752b9a1c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)`</span></span><br><span class="line">![<span class="string">新浪</span>](<span class="link">http://upload-images.jianshu.io/upload_images/1334313-76fcda5b752b9a1c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240</span>)</span><br><span class="line"><span class="bullet">* </span>图片链接：<span class="code">`[![](https://ss1.bdstatic.com/kvoZeXSm1A5BphGlnYG/icon/weather/aladdin/jpg/a1.jpg)](https://www.zhihu.com)`</span></span><br><span class="line">[<span class="string">![</span>](<span class="link">https://ss1.bdstatic.com/kvoZeXSm1A5BphGlnYG/icon/weather/aladdin/jpg/a1.jpg</span>)](<span class="link">https://www.zhihu.com</span>)</span><br><span class="line"><span class="bullet">* </span>内部跳转： [<span class="string">标题</span>](<span class="link">#标题</span>)   <span class="code">`[标题](#标题)`</span></span><br><span class="line"></span><br><span class="line"><span class="section"># 脚注</span></span><br><span class="line">BlaBlaBla...这是一段脚注[^footer1]，接着BlaBlaBla...</span><br><span class="line">......</span><br><span class="line">[<span class="symbol">^footer1</span><span class="link">]:这是脚注内容，Blablabla</span></span><br></pre></td></tr></table></figure></p>
<p>BlaBlaBla...这是一段脚注[^footer1]，接着BlaBlaBla...
......
[^footer1]:这是脚注内容，Blablabla</p>
<pre><code>
# 其它
* Hexo只支持最基础的Markdown语法，所以需要安装[扩展](https://github.com/celsomiranda/hexo-renderer-markdown-it)。
* 和Hexo的Markdown引擎差不多的编辑器真心不多，我现在用[Atom](https://atom.io)，感觉还行（Preference -&gt; Settings -&gt; 选中Soft Wrap开启自动换行）。</code></pre>
]]></content>
    <summary type="html">
    <![CDATA[<h1>标题</h1>
<ul>
<li>H1 :</li>
</ul>
<h1>Header 1 <code># Header1</code> or 下一行加三个等号｀===｀</h1>
<ul>
<li>H2 :</li>
</ul>
<h2>Header 2 <code>#]]>
    </summary>
    
  </entry>
  
</feed>
